<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CV Gen</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Edu+AU+VIC+WA+NT+Dots:wght@400..700&display=swap" rel="stylesheet">

  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="mask-icon" href="safari-pinned-tab.svg" color="#2c3e50">
  <link rel="shortcut icon" href="favicon.ico">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://unpkg.com/pizzip@3.0.6/dist/pizzip.min.js"></script>
  <script src="https://unpkg.com/docxtemplater@3.30.2/build/docxtemplater.js"></script>
  <script src="https://unpkg.com/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<style>
:root {
    --primary: #2c3e50;
    --secondary: #3498db;
    --light: #ecf0f1;
    --dark: #2c3e50;
    --success: #27ae60;
    --beige: #F5F5DC;
    --brown: #8B4513;
    --skyblue: #87CEEB;
    --gray: #808080;
    --pink: #FFC0CB;
    --red: #FF0000;
    --lightyellow: #FFFFE0;
    --darkyellow: #FFD700;
    --gold: #FFD700;
    --dark-bg: #1a1a1a;
--placeholder:#f1c40f;
}
/* ðŸ”§ Couleur des placeholders (fonctionne partout) */
input::placeholder,
textarea::placeholder {
  color: var(--placeholder) !important; /* Jaune or */
  opacity: 0;
}

input::-webkit-input-placeholder,
textarea::-webkit-input-placeholder {
  color: var(--placeholder) !important;
}

input:-ms-input-placeholder,
textarea:-ms-input-placeholder {
  color:var(--placeholder) !important;
}

input::-ms-input-placeholder,
textarea::-ms-input-placeholder {
  color: var(--placeholder) !important;
}




/* ==================== STYLE MODERNISÃ‰ (SAUF PRÃ‰VISUALISATION) ==================== */
body {
    background-color: var(--dark-bg);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #e0e0e0;
    padding-top: 0;
    line-height: 1.6;
}


/* Navbar modernisÃ©e */
.header {
  background-color: transparent;

  padding: 12px 0;
  position: relative;
  top: 0;
  z-index: 1000;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}


.logo-container {
display: flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
}
.text-container {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
  flex: 0 1 auto;
}

.header .container {
  display: flex;
  align-items: center;
  justify-content: space-between;
  max-width: 1200px;
  margin: 0 auto;
  padding: 0 20px;
}



.navbar-icon {
  width: 10%;
  height: 10%;
  border-radius: 100%;
  
  padding: 2px;
  background: transparent;
  object-fit: contain;
  transition: all 0.3s ease;
}

.navbar-icon:hover {
  transform: scale(1.05);
  border-color: rgba(255, 255, 255, 0.4);
}

.text-container h1 {
font-family: "Edu AU VIC WA NT Dots", cursive;
  font-optical-sizing: auto;
  font-weight: <weight>;
  font-style: normal;

  font-size: 3rem;
  margin: 0;
  font-weight: 400;
  color: var(--placeholder);
  letter-spacing: -1px;
}

.text-container h1 i {
  margin-right: 10px;
  color: #FFD700;
}

.text-container .lead {
  margin: 10px 0 0 0;
  font-size: 1rem;
  opacity: 0.7;
  color: rgba(255, 255, 255, 0.8);
letter-spacing: 2px;

font-family: "Edu AU VIC WA NT Dots", cursive;
  font-optical-sizing: auto;
  font-weight: <weight>;
  font-style: normal;
}

#installButton {
  background-color: transparent;
  color: white;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  transition: all 0.3s ease;
}

#installButton:hover {
  background-color: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.4);
  transform: scale(1.1);
}

#installButton i {
  font-size: 1.2rem;
}

/* Cartes modernisÃ©es */
.card {
    border-radius: 8px;
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
    border: none;
margin-top: 10px;
    margin-bottom: 25px;
    transition: transform 0.3s ease;
    background-color: #2d2d2d;
}

.card:hover {
    transform: translateY(-5px);
}

.card-header {
    background-color: #2d2d2d;
    color: white;
    font-weight: 600;
    border-radius: 8px 8px 0 0 !important;
    padding: 15px 20px;
    border-bottom: 2px solid var(--gold);
}

.form-section {
    padding: 20px;
}

.array-item {
    border: 1px solid rgba(255, 215, 0, 0.15);
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 20px;
    background: rgba(45, 45, 45, 0.7);
    position: relative;
}

.btn-add {
    margin-top: 10px;
    background: var(--gold);
    border: none;
    font-weight: 500;
    color: #333;
}

.btn-add:hover {
    background: #e6c200;
}

.btn-remove {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    background-color: #ff4444;
    color: white;
    border: none;
}

/* Styles pour les inputs */
.form-control {
    background-color: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #f0f0f0;
    transition: all 0.3s;
}

.form-control:focus {
    background-color: rgba(255, 255, 255, 0.15);
    border-color: var(--gold);
    box-shadow: 0 0 0 0.25rem rgba(255, 215, 0, 0.15);
    color: white;
}

.form-label {
    color: #e0e0e0;
    font-weight: 500;
}

/* ==================== PRÃ‰VISUALISATION (STYLE ORIGINAL) ==================== */
.preview-container {
    background: #2d2d2d;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
    min-height: 100%;
    overflow: auto;
}

.cv-preview {
    background: white;
    border: 1px solid #e0e6ed;
    padding: 30px;
    font-family: 'Calibri', sans-serif;
    color: #333;
    min-height: 842px;
    width: 595px;
    position: relative;
    margin: 0 auto;
    box-sizing: border-box;
}

.cv-header-grid {
    display: flex;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
}

.cv-header-grid .photo-col {
    flex: 0 0 auto;
    width: 25%;
    text-align: center;
}

.cv-header-grid .info-col {
    flex: 1 1 auto;
    width: 75%;
    padding-left: 20px;
}

.cv-name {
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 5px;
}

.cv-title {
    font-size: 14px;
    font-weight: 500;
    color: #444;
    margin-bottom: 15px;
}

.cv-section {
    margin-bottom: 25px;
}

.section-title {
    font-size: 14px;
    font-weight: bold;
    padding-bottom: 5px;
    margin-bottom: 15px;
}

.cv-preview p,
.cv-preview ul li,
.cv-preview .badge-skill,
.cv-preview .language-item,
.cv-preview .hobby-item,
.cv-preview .experience-title,
.cv-preview .cv-experience .experience-company,
.cv-preview .cv-formation>div {
    font-size: 10px;
}

.cv-contact {
    display: block;
    margin-bottom: 15px;
    text-align: left;
}

.contact-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
}

.contact-item span {
    font-size: 11px;
}

.contact-item .contact-icon i {
    margin-right: 8px;
}

.cv-experience,
.cv-formation {
    margin-bottom: 20px;
}

.experience-title {
    font-weight: bold;
    margin-bottom: 5px;
}

.experience-company {
    font-weight: 500;
    margin-bottom: 5px;
}

.experience-date {
    color: #777;
    font-style: italic;
    margin-bottom: 8px;
    font-size: 9px;
}

.experience-tasks {
    padding-left: 20px;
}

.cv-formation>div:nth-child(2),
.cv-formation>div:nth-child(3) {
    font-size: 9px;
}

.cv-footer {
    position: absolute;
    bottom: 20px;
    left: 0;
    right: 0;
    text-align: center;
    font-size: 10px;
    color: #777;
    padding: 0 30px;
}

.badge-skill {
    padding: 5px 10px;
    border-radius: 4px;
    margin: 0 5px 5px 0;
    display: inline-block;
}

.action-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    margin: 0 10px;
    transition: all 0.3s;
    border: none;
    background: transparent;
}

.action-btn:hover {
    transform: scale(1.1);
}

.action-btn i {
    transition: all 0.3s;
}

.action-btn:hover i {
    transform: scale(1.2);
}

.preview-actions {
    display: flex;
    justify-content: center;
    margin-top: 30px;
    gap: 15px;
}

.photo-preview {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    margin: 0 auto 20px;
    display: block;
    background: #f0f0f0;
    border: none;
}

.language-item {
    margin-bottom: 8px;
    display: flex;
}

.language-name {
    width: 100px;
    font-weight: 500;
}

.language-level {
    flex-grow: 1;
}

.hobbies-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.hobby-item {
    padding: 5px 15px;
    border-radius: 20px;
    font-size: 14px;
    background: transparent;
    border: 1px solid #ddd;
}

/* ==================== AUTRES STYLES ==================== */
.color-palette {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 15px;
}

.color-option {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    border: 2px solid transparent;
    transition: all 0.3s;
}

.color-option:hover {
    transform: scale(1.1);
}

.color-option.active {
    border-color: #000;
    box-shadow: 0 0 0 2px white, 0 0 0 4px #000;
}

.beige-brown {
    background: linear-gradient(135deg, var(--beige), var(--brown));
}

.blue-gray {
    background: linear-gradient(135deg, var(--skyblue), var(--gray));
}

.pink-red {
    background: linear-gradient(135deg, var(--pink), var(--red));
}

.yellow {
    background: linear-gradient(135deg, var(--lightyellow), var(--darkyellow));
}

.social-inputs {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-top: 15px;
}

.download-message {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 15px 25px;
    border-radius: 50px;
    z-index: 1000;
    display: flex;
    align-items: center;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
}

.download-message i {
    margin-right: 10px;
    font-size: 1.2em;
}

.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.7);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    color: white;
    font-size: 24px;
    flex-direction: column;
}

.spinner {
    width: 50px;
    height: 50px;
    border: 5px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: white;
    animation: spin 1s linear infinite;
    margin-bottom: 20px;
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* ==================== RESPONSIVE ==================== */
@media (max-width: 768px) {
    .navbar-brand {
        font-size: 1.1rem;
    }
    
    .navbar-brand::before {
        width: 28px;
        height: 28px;
    }
    
    #installButton {
        padding: 6px 15px;
        font-size: 0.9rem;
    }
}
</style>
</head>

<body> 
<div class="header">
  <div class="container d-flex align-items-center justify-content-between">
    <img src="android-chrome-512x512.png" class="navbar-icon" alt="Logo">

    <div class="text-center mx-auto text-container">
      <h1>CV by Sergio</h1>
      <p class="lead">CrÃ©ez votre CV en quelques minutes</p>
    </div>

    <button id="installButton" style="display: none;" class="btn-primary">
      <i class="fas fa-download"></i>
    </button>
  </div>
</div>

    <div class="container">
    <div class="row">
      <div class="col-lg-6">
        <div class="card">
          <div class="card-header">
            <i class="fas fa-edit me-2"></i>Informations Personnelles
          </div>
          <div class="form-section">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="prenom" class="form-label">PrÃ©nom *</label>
                <input type="text" class="form-control" id="prenom" placeholder="Votre prÃ©nom">
              </div>
              <div class="col-md-6 mb-3">
                <label for="nom" class="form-label">Nom *</label>
                <input type="text" class="form-control" id="nom" placeholder="Votre nom">
              </div>
            </div>
            <div class="mb-3">
              <label for="poste" class="form-label">Poste recherchÃ© *</label>
              <input type="text" class="form-control" id="poste" placeholder="Ex: Assistant de direction">
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="email" class="form-label">Email *</label>
                <input type="email" class="form-control" id="email" placeholder="email@exemple.com">
              </div>
              <div class="col-md-6 mb-3">
                <label for="telephone" class="form-label">TÃ©lÃ©phone *</label>
                <input type="tel" class="form-control" id="telephone" placeholder="00 00 00 00 00">
              </div>
            </div>
            <div class="mb-3">
              <label for="lieu" class="form-label">Ville, Pays *</label>
              <input type="text" class="form-control" id="lieu" placeholder="Paris, France">
            </div>
            <div class="social-inputs">
              <div class="mb-3">
                <label for="linkedin" class="form-label">LinkedIn</label>
                <input type="text" class="form-control" id="linkedin" placeholder="Votre profil LinkedIn">
              </div>
              <div class="mb-3">
                <label for="website" class="form-label">Site Web</label>
                <input type="text" class="form-control" id="website" placeholder="Votre site web">
              </div>
            </div>
            <div class="mb-3">
              <label for="photo" class="form-label">Photo de profil</label>
              <input type="file" class="form-control" id="photo" accept="image/*">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <i class="fas fa-user me-2"></i>Profil Personnel
          </div>
          <div class="form-section">
            <div class="mb-3">
              <label for="profil" class="form-label">Description de votre profil *</label>
              <textarea class="form-control" id="profil" rows="4"
                placeholder="DÃ©crivez votre profil professionnel"></textarea>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <i class="fas fa-briefcase me-2"></i>ExpÃ©riences Professionnelles
          </div>
          <div class="form-section">
            <div id="experiences-container">
              <div class="array-item experience-item">
                <button type="button" class="btn btn-danger btn-remove"><i class="fas fa-times"></i></button>
                <div class="mb-3">
                  <label class="form-label">Entreprise *</label>
                  <input type="text" class="form-control" name="entreprise" placeholder="Nom de l'entreprise">
                </div>
                <div class="mb-3">
                  <label class="form-label">Poste occupÃ© *</label>
                  <input type="text" class="form-control" name="posteExp" placeholder="Votre poste">
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Date de dÃ©but *</label>
                    <input type="text" class="form-control" name="debutExp" placeholder="MM/AAAA">
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Date de fin *</label>
                    <input type="text" class="form-control" name="finExp" placeholder="MM/AAAA ou Aujourd'hui">
                  </div>
                </div>
                <div class="mb-3">
                  <label class="form-label">TÃ¢ches rÃ©alisÃ©es *</label>
                  <textarea class="form-control" name="taches" rows="3"
                    placeholder="DÃ©crivez vos responsabilitÃ©s, une par ligne"></textarea>
                </div>
              </div>

              <div class="array-item experience-item">
                <button type="button" class="btn btn-danger btn-remove"><i class="fas fa-times"></i></button>
                <div class="mb-3">
                  <label class="form-label">Entreprise *</label>
                  <input type="text" class="form-control" name="entreprise" placeholder="Nom de l'entreprise">
                </div>
                <div class="mb-3">
                  <label class="form-label">Poste occupÃ© *</label>
                  <input type="text" class="form-control" name="posteExp" placeholder="Votre poste">
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Date de dÃ©but *</label>
                    <input type="text" class="form-control" name="debutExp" placeholder="MM/AAAA">
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Date de fin *</label>
                    <input type="text" class="form-control" name="finExp" placeholder="MM/AAAA ou Aujourd'hui">
                  </div>
                </div>
                <div class="mb-3">
                  <label class="form-label">TÃ¢ches rÃ©alisÃ©es *</label>
                  <textarea class="form-control" name="taches" rows="3"
                    placeholder="DÃ©crivez vos responsabilitÃ©s, une par ligne">
                  </textarea>
                </div>
              </div>
            </div>
            <button type="button" id="add-experience" class="btn btn-primary btn-add">
              <i class="fas fa-plus me-1"></i> Ajouter une expÃ©rience
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <i class="fas fa-graduation-cap me-2"></i>Formations
          </div>
          <div class="form-section">
            <div id="formations-container">
              <div class="array-item formation-item">
                <button type="button" class="btn btn-danger btn-remove"><i class="fas fa-times"></i></button>
                <div class="mb-3">
                  <label class="form-label">DiplÃ´me *</label>
                  <input type="text" class="form-control" name="diplome" placeholder="Nom du diplÃ´me">
                </div>
                <div class="mb-3">
                  <label class="form-label">Ã‰cole/UniversitÃ© *</label>
                  <input type="text" class="form-control" name="ecole" placeholder="Nom de l'Ã©tablissement">
                </div>
                <div class="mb-3">
                  <label class="form-label">AnnÃ©es d'Ã©tudes *</label>
                  <input type="text" class="form-control" name="annees" placeholder="Ex: 2015-2017">
                </div>
                <div class="mb-3">
                  <label class="form-label">Lieu *</label>
                  <input type="text" class="form-control" name="lieuFormation" placeholder="Ville, Pays">
                </div>
              </div>

              <div class="array-item formation-item">
                <button type="button" class="btn btn-danger btn-remove"><i class="fas fa-times"></i></button>
                <div class="mb-3">
                  <label class="form-label">DiplÃ´me *</label>
                  <input type="text" class="form-control" name="diplome" placeholder="Nom du diplÃ´me">
                </div>
                <div class="mb-3">
                  <label class="form-label">Ã‰cole/UniversitÃ© *</label>
                  <input type="text" class="form-control" name="ecole" placeholder="Nom de l'Ã©tablissement">
                </div>
                <div class="mb-3">
                  <label class="form-label">AnnÃ©es d'Ã©tudes *</label>
                  <input type="text" class="form-control" name="annees" placeholder="Ex: 2012-2015">
                </div>
                <div class="mb-3">
                  <label class="form-label">Lieu *</label>
                  <input type="text" class="form-control" name="lieuFormation" placeholder="Ville, Pays">
                </div>
              </div>
            </div>
            <button type="button" id="add-formation" class="btn btn-primary btn-add">
              <i class="fas fa-plus me-1"></i> Ajouter une formation
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <i class="fas fa-star me-2"></i>CompÃ©tences & Centres d'intÃ©rÃªt
          </div>
          <div class="form-section">
            <div class="mb-3">
              <label class="form-label">CompÃ©tences *</label>
              <textarea class="form-control" id="competences" rows="3"
                placeholder="SÃ©parer par des virgules"></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Langues *</label>
              <textarea class="form-control" id="langues" rows="2"
                placeholder="Format: Langue:Niveau, sÃ©parer par des virgules"></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Centres d'intÃ©rÃªt *</label>
              <textarea class="form-control" id="hobbies" rows="2" placeholder="SÃ©parer par des virgules"></textarea>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <i class="fas fa-palette me-2"></i>Personnalisation du CV
          </div>
          <div class="form-section">
            <div class="mb-3">
              <label class="form-label">Choisissez une palette de couleurs</label>
              <div class="color-palette">
                <div class="color-option beige-brown active" data-palette="beige-brown" title="Beige et Marron"></div>
                <div class="color-option blue-gray" data-palette="blue-gray" title="Bleu ciel et Gris"></div>
                <div class="color-option pink-red" data-palette="pink-red" title="Rose pÃ¢le et Rouge"></div>
                <div class="color-option yellow" data-palette="yellow" title="Jaune clair et Jaune foncÃ©"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="card">
          <div class="card-header">
            <i class="fas fa-eye me-2"></i>PrÃ©visualisation du CV
          </div>
          <div class="preview-container">
            <div class="cv-preview">
              <div class="cv-header-grid">
                <div class="photo-col">
                  <img id="photo-preview" src="https://via.placeholder.com/120" alt="Photo" class="photo-preview">
                </div>
                <div class="info-col">
                  <div class="cv-name" id="preview-name">PrÃ©nom Nom</div>
                  <div class="cv-title" id="preview-title">Poste recherchÃ©</div>
                  <div class="cv-contact" id="preview-contact">
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-5">
                  <div class="cv-section">
                    <div class="section-title" id="profile-title">PROFIL</div>
                    <p id="preview-profile"></p>
                  </div>

                  <div class="cv-section">
                    <div class="section-title">COMPÃ‰TENCES</div>
                    <div id="preview-competences">
                    </div>
                  </div>

                  <div class="cv-section">
                    <div class="section-title">LANGUES</div>
                    <div id="preview-langues">
                    </div>
                  </div>

                  <div class="cv-section">
                    <div class="section-title">CENTRES D'INTÃ‰RÃŠT</div>
                    <div id="preview-hobbies">
                    </div>
                  </div>
                </div>

                <div class="col-7">
                  <div class="cv-section">
                    <div class="section-title">EXPÃ‰RIENCE PROFESSIONNELLE</div>
                    <div id="preview-experiences">
                    </div>
                  </div>

                  <div class="cv-section">
                    <div class="section-title">FORMATION</div>
                    <div id="preview-formations">
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="preview-actions">
              <button type="button" id="preview-btn" class="action-btn" title="Mettre Ã  jour">
                <i class="fas fa-sync"></i>
              </button>

              <button type="button" id="generate-pdf" class="action-btn" title="TÃ©lÃ©charger en PDF">
                <i class="fas fa-file-pdf"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Variables de couleur
    let currentPalette = 'beige-brown';
    let deferredPrompt; // Pour la PWA

    // RÃ©cupÃ¨re le bouton d'installation
    const installButton = document.getElementById('installButton');

    // --- Logique PWA (Progressive Web App) ---

    // Gestion de l'Ã©vÃ©nement 'beforeinstallprompt' :
    // Cet Ã©vÃ©nement est dÃ©clenchÃ© par le navigateur lorsqu'une PWA peut Ãªtre installÃ©e.
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault(); // EmpÃªche le prompt automatique du navigateur
      deferredPrompt = e;
      console.log('Installation PWA disponible');

      // Afficher le bouton d'installation si l'installation est possible
      if (installButton) {
        installButton.style.display = 'inline-block'; // Rendre le bouton visible
        installButton.disabled = false; // S'assurer qu'il n'est pas dÃ©sactivÃ©
        installButton.title = 'Installer l\'application'; // RÃ©initialiser le titre
      }
    });

    // GÃ©rer le clic sur le bouton d'installation
    if (installButton) {
      installButton.addEventListener('click', async () => {
        if (deferredPrompt) {
          // Afficher le prompt d'installation au moyen de l'Ã©vÃ©nement sauvegardÃ©
          deferredPrompt.prompt();
          // Attendre la rÃ©ponse de l'utilisateur (acceptÃ© ou refusÃ©)
          const { outcome } = await deferredPrompt.userChoice;
          console.log(`RÃ©ponse de l'utilisateur Ã  l'installation: ${outcome}`);

          if (outcome === 'accepted') {
            showSuccessMessage('Application installÃ©e avec succÃ¨s !');
          } else {
            console.log('Installation refusÃ©e par l\'utilisateur.');
            // Si l'utilisateur refuse, le bouton reste visible pour rÃ©essayer plus tard
          }
          deferredPrompt = null; // RÃ©initialiser deferredPrompt aprÃ¨s le prompt
        } else {
          // Fallback si 'beforeinstallprompt' n'a pas Ã©tÃ© dÃ©clenchÃ© ou a dÃ©jÃ  Ã©tÃ© consommÃ©
          showErrorMessage('L\'installation est en attente ou non supportÃ©e. Veuillez rÃ©essayer ou vÃ©rifier le support PWA de votre navigateur.');
        }
      });
    }

    // Ã‰vÃ©nement dÃ©clenchÃ© lorsque l'application est dÃ©jÃ  installÃ©e
    window.addEventListener('appinstalled', () => {
      // Cache le bouton d'installation si l'application vient d'Ãªtre installÃ©e
      if (installButton) {
        installButton.style.display = 'none';
      }
      console.log('PWA a Ã©tÃ© installÃ©e avec succÃ¨s !');
    });

    // Enregistrement du Service Worker
    // Le Service Worker gÃ¨re la mise en cache des ressources pour le mode hors ligne.
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => { // Utiliser 'load' pour s'assurer que tout le DOM est chargÃ©
        navigator.serviceWorker.register('./service-worker.js')
          .then(registration => {
            console.log('Service Worker enregistrÃ© avec la portÃ©e :', registration.scope);
          })
          .catch(error => {
            console.error('Ã‰chec de l\'enregistrement du Service Worker :', error);
          });
      });
    }

    // --- Fin de la logique PWA ---

    // Gestion des expÃ©riences
    document.getElementById('add-experience').addEventListener('click', function () {
      const container = document.getElementById('experiences-container');
      // Clone le premier Ã©lÃ©ment existant pour crÃ©er un nouveau champ
      const items = container.querySelectorAll('.experience-item');
      const newItem = items[0].cloneNode(true);

      // RÃ©initialiser les valeurs des champs du nouvel Ã©lÃ©ment
      newItem.querySelectorAll('input').forEach(input => input.value = '');
      newItem.querySelector('textarea').value = '';

      container.appendChild(newItem);
    });

    // Gestion des formations
    document.getElementById('add-formation').addEventListener('click', function () {
      const container = document.getElementById('formations-container');
      // Clone le premier Ã©lÃ©ment existant pour crÃ©er un nouveau champ
      const items = container.querySelectorAll('.formation-item');
      const newItem = items[0].cloneNode(true);

      // RÃ©initialiser les valeurs des champs du nouvel Ã©lÃ©ment
      newItem.querySelectorAll('input').forEach(input => input.value = '');

      container.appendChild(newItem);
    });

    // Supprimer un Ã©lÃ©ment (expÃ©rience ou formation)
    document.addEventListener('click', function (e) {
      if (e.target.closest('.btn-remove')) {
        const item = e.target.closest('.array-item');
        const container = item.parentElement;
        // Ne pas supprimer s'il ne reste qu'un seul Ã©lÃ©ment (pour Ã©viter un formulaire vide)
        if (container.children.length > 1) {
          item.remove();
        }
      }
    });

    // Mise Ã  jour de la photo de profil
    document.getElementById('photo').addEventListener('change', function (e) {
      if (this.files && this.files[0]) {
        const reader = new FileReader();
        reader.onload = function (event) {
          const img = new Image();
          img.onload = function () {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const size = 120; // Taille dÃ©sirÃ©e pour l'image de prÃ©visualisation
            canvas.width = size;
            canvas.height = size;

            // Calculer les dimensions pour recadrer l'image au centre
            const imgAspectRatio = img.width / img.height;
            const canvasAspectRatio = canvas.width / canvas.height;
            let sx, sy, sWidth, sHeight;

            if (imgAspectRatio > canvasAspectRatio) {
              sHeight = img.height;
              sWidth = img.height * canvasAspectRatio;
              sx = (img.width - sWidth) / 2;
              sy = 0;
            } else {
              sWidth = img.width;
              sHeight = img.width / canvasAspectRatio;
              sx = 0;
              sy = (img.height - sHeight) / 2;
            }

            // Appliquer un masque circulaire au canvas
            ctx.beginPath();
            ctx.arc(size / 2, size / 2, size / 2, 0, Math.PI * 2);
            ctx.closePath();
            ctx.clip();

            // Dessiner l'image recadrÃ©e et masquÃ©e sur le canvas
            ctx.drawImage(img, sx, sy, sWidth, sHeight, 0, 0, size, size);
            document.getElementById('photo-preview').src = canvas.toDataURL('image/png');
          };
          img.src = event.target.result;
        };
        reader.readAsDataURL(this.files[0]);
      }
    });

    // Gestion des palettes de couleurs
    document.querySelectorAll('.color-option').forEach(option => {
      option.addEventListener('click', function () {
        // Supprimer la classe 'active' de tous les autres options
        document.querySelectorAll('.color-option').forEach(opt => {
          opt.classList.remove('active');
        });
        // Ajouter la classe 'active' Ã  l'option cliquÃ©e
        this.classList.add('active');
        currentPalette = this.dataset.palette; // Mettre Ã  jour la palette sÃ©lectionnÃ©e
        updatePreview(); // Mettre Ã  jour la prÃ©visualisation avec les nouvelles couleurs
      });
    });

    // Bouton de prÃ©visualisation
    document.getElementById('preview-btn').addEventListener('click', updatePreview);

    // Mettre Ã  jour la prÃ©visualisation au chargement initial de la page
    updatePreview();

    // Fonction pour mettre Ã  jour la prÃ©visualisation du CV
    function updatePreview() {
      // Mettre Ã  jour les informations de base (nom, poste, profil)
      document.getElementById('preview-name').textContent =
        `${document.getElementById('prenom').value} ${document.getElementById('nom').value}`;

      document.getElementById('preview-title').textContent =
        document.getElementById('poste').value;

      document.getElementById('preview-profile').textContent =
        document.getElementById('profil').value;

      // Mettre Ã  jour la section contact
      const contactContainer = document.getElementById('preview-contact');
      contactContainer.innerHTML = ''; // Vider le contenu prÃ©cÃ©dent

      const contactItems = [
        { icon: 'map-marker-alt', value: document.getElementById('lieu').value, id: 'location' },
        { icon: 'phone', value: document.getElementById('telephone').value, id: 'phone' },
        { icon: 'envelope', value: document.getElementById('email').value, id: 'email' },
        { icon: 'linkedin', value: document.getElementById('linkedin').value, id: 'linkedin' },
        { icon: 'globe', value: document.getElementById('website').value, id: 'website' }
      ];

      contactItems.forEach(item => {
        if (item.value) { // N'afficher que si la valeur est prÃ©sente
          const contactHTML = `
            <div class="contact-item">
              <span class="contact-icon"><i class="fas fa-${item.icon}"></i></span>
              <span id="preview-${item.id}">${item.value}</span>
            </div>
          `;
          contactContainer.innerHTML += contactHTML;
        }
      });

      // Mettre Ã  jour les couleurs basÃ©es sur la palette sÃ©lectionnÃ©e
      updateColors();

      // Mettre Ã  jour les expÃ©riences professionnelles
      const expContainer = document.getElementById('preview-experiences');
      expContainer.innerHTML = '';

      document.querySelectorAll('.experience-item').forEach(item => {
        const entreprise = item.querySelector('[name="entreprise"]').value;
        const poste = item.querySelector('[name="posteExp"]').value;
        const debut = item.querySelector('[name="debutExp"]').value;
        const fin = item.querySelector('[name="finExp"]').value;
        const taches = item.querySelector('[name="taches"]').value.split('\n').filter(t => t.trim() !== '');

        if (entreprise || poste) {
          const expHTML = `
            <div class="cv-experience">
              <div class="experience-company">${entreprise}</div>
              <div class="experience-title">${poste}</div>
              <div class="experience-date">${debut} - ${fin}</div>
              <ul class="experience-tasks">
                ${taches.map(t => `<li>${t}</li>`).join('')}
              </ul>
            </div>
          `;
          expContainer.innerHTML += expHTML;
        }
      });

      // Mettre Ã  jour les formations
      const formContainer = document.getElementById('preview-formations');
      formContainer.innerHTML = '';

      document.querySelectorAll('.formation-item').forEach(item => {
        const diplome = item.querySelector('[name="diplome"]').value;
        const ecole = item.querySelector('[name="ecole"]').value;
        const annees = item.querySelector('[name="annees"]').value;
        const lieu = item.querySelector('[name="lieuFormation"]').value;

        if (diplome || ecole) {
          const formHTML = `
            <div class="cv-formation">
              <div class="experience-title">${diplome}</div>
              <div>${ecole} | ${lieu}</div>
              <div class="experience-date">${annees}</div>
            </div>
          `;
          formContainer.innerHTML += formHTML;
        }
      });

      // Mettre Ã  jour les compÃ©tences
      const compContainer = document.getElementById('preview-competences');
      compContainer.innerHTML = '';

      const competences = document.getElementById('competences').value.split(',').map(c => c.trim()).filter(c => c !== '');
      competences.forEach(comp => {
        compContainer.innerHTML += `<div class="badge-skill">${comp}</div>`;
      });

      // Mettre Ã  jour les langues
      const langContainer = document.getElementById('preview-langues');
      langContainer.innerHTML = '';

      const langues = document.getElementById('langues').value.split(',').map(l => l.trim()).filter(l => l !== '');
      langues.forEach(lang => {
        const [nom, niveau] = lang.split(':').map(p => p.trim());
        if (nom && niveau) {
          langContainer.innerHTML += `
            <div class="language-item">
              <div class="language-name">${nom}:</div>
              <div class="language-level">${niveau}</div>
            </div>
          `;
        }
      });

      // Mettre Ã  jour les centres d'intÃ©rÃªt (Hobbies)
      const hobbiesContainer = document.getElementById('preview-hobbies');
      hobbiesContainer.innerHTML = '';

      const hobbies = document.getElementById('hobbies').value.split(',').map(h => h.trim()).filter(h => h !== '');
      hobbies.forEach(hobby => {
        hobbiesContainer.innerHTML += `<div class="hobby-item">${hobby}</div>`;
      });
    }

    // Fonction pour mettre Ã  jour les couleurs du CV en fonction de la palette sÃ©lectionnÃ©e
    function updateColors() {
      const primaryColor = getPrimaryColor();
      const secondaryColor = getSecondaryColor();

      document.querySelectorAll('.cv-name, .section-title, .experience-company').forEach(el => {
        el.style.color = primaryColor;
      });

      document.querySelectorAll('.cv-title, .experience-title').forEach(el => {
        el.style.color = '#444'; // Couleur de texte fixe pour ces Ã©lÃ©ments
      });

      document.querySelectorAll('.section-title').forEach(el => {
        el.style.borderBottom = `1px solid ${primaryColor}`;
      });

      document.querySelectorAll('.badge-skill').forEach(el => {
        el.style.background = secondaryColor;
        el.style.color = getContrastColor(secondaryColor); // Ajuster la couleur du texte pour le contraste
      });

      document.querySelectorAll('.contact-icon i').forEach(el => {
        el.style.color = primaryColor;
      });

      document.querySelectorAll('.action-btn i').forEach(el => {
        el.style.color = primaryColor;
      });
    }

    // Fonctions pour obtenir les couleurs primaires et secondaires selon la palette
    function getPrimaryColor() {
      switch (currentPalette) {
        case 'beige-brown': return '#8B4513';
        case 'blue-gray': return '#808080';
        case 'pink-red': return '#FF0000';
        case 'yellow': return '#FFD700';
        default: return '#2c3e50'; // Couleur par dÃ©faut
      }
    }

    function getSecondaryColor() {
      switch (currentPalette) {
        case 'beige-brown': return '#F5F5DC';
        case 'blue-gray': return '#87CEEB';
        case 'pink-red': return '#FFC0CB';
        case 'yellow': return '#FFFFE0';
        default: return '#3498db'; // Couleur par dÃ©faut
      }
    }

    // Fonction pour dÃ©terminer une couleur de texte contrastante (noir ou blanc)
    function getContrastColor(hexColor) {
      const r = parseInt(hexColor.substr(1, 2), 16);
      const g = parseInt(hexColor.substr(3, 2), 16);
      const b = parseInt(hexColor.substr(5, 2), 16);
      // Calculer la luminositÃ© perÃ§ue (ITU-R BT.709)
      const brightness = (r * 299 + g * 587 + b * 114) / 1000;
      return brightness > 128 ? '#000' : '#fff'; // Retourne noir pour couleurs claires, blanc pour couleurs sombres
    }

    // TÃ©lÃ©charger le CV en PDF
    document.getElementById('generate-pdf').addEventListener('click', async function () {
      const loadingOverlay = showLoading(); // Afficher l'indicateur de chargement
      try {
        const element = document.querySelector('.cv-preview'); // Cible l'Ã©lÃ©ment Ã  convertir
        const prenom = document.getElementById('prenom').value;
        const nom = document.getElementById('nom').value;

        // Convertir l'Ã©lÃ©ment HTML en canvas (image)
        const canvas = await html2canvas(element, {
          scale: 2, // Augmenter la rÃ©solution pour une meilleure qualitÃ©
          useCORS: true,
          logging: false
        });

        const imgData = canvas.toDataURL('image/png'); // Obtenir les donnÃ©es de l'image
        const pdf = new jspdf.jsPDF({
          orientation: 'portrait',
          unit: 'pt',
          format: 'a4'
        });

        // Calculer les dimensions pour que l'image tienne sur la page PDF
        const imgWidth = canvas.width;
        const imgHeight = canvas.height;
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = pdf.internal.pageSize.getHeight();
        const ratio = Math.min(pdfWidth / imgWidth, pdfHeight / imgHeight);
        const finalWidth = imgWidth * ratio;
        const finalHeight = imgHeight * ratio;
        const x = (pdfWidth - finalWidth) / 2;
        const y = (pdfHeight - finalHeight) / 2;

        pdf.addImage(imgData, 'PNG', x, y, finalWidth, finalHeight); // Ajouter l'image au PDF
        pdf.save(`CV_${prenom}_${nom}.pdf`); // Sauvegarder le PDF
        showSuccessMessage("Votre CV PDF est prÃªt au tÃ©lÃ©chargement");

      } catch (error) {
        console.error("Erreur lors de la gÃ©nÃ©ration du PDF:", error);
        showErrorMessage("Erreur lors de la gÃ©nÃ©ration du document PDF. Veuillez rÃ©essayer.");
      } finally {
        document.body.removeChild(loadingOverlay); // Cacher l'indicateur de chargement
      }
    });

    // Fonctions pour afficher les messages de chargement, succÃ¨s et erreur
    function showLoading() {
      const overlay = document.createElement('div');
      overlay.className = 'loading-overlay';
      overlay.innerHTML = `
        <div class="spinner"></div>
        <div>GÃ©nÃ©ration du document en cours...</div>
      `;
      document.body.appendChild(overlay);
      return overlay;
    }

    function showSuccessMessage(message) {
      const successMsg = document.createElement('div');
      successMsg.className = 'download-message';
      successMsg.innerHTML = `
        <i class="fas fa-check-circle"></i>
        <div>${message}</div>
      `;
      document.body.appendChild(successMsg);
      setTimeout(() => successMsg.remove(), 3000); // Supprimer aprÃ¨s 3 secondes
    }

    function showErrorMessage(message) {
      const errorMsg = document.createElement('div');
      errorMsg.className = 'download-message';
      errorMsg.style.background = 'rgba(220, 53, 69, 0.9)'; // Fond rouge pour l'erreur
      errorMsg.innerHTML = `
        <i class="fas fa-exclamation-circle"></i>
        <div>${message}</div>
      `;
      document.body.appendChild(errorMsg);
      setTimeout(() => errorMsg.remove(), 5000); // Supprimer aprÃ¨s 5 secondes
    }
  });
</script>


</body>

</html>
